<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Track Your Shipment</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; background:#f5f6f8; padding:20px; }
    .box {
      max-width:800px; margin:auto; background:#fff; padding:20px;
      border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.08);
    }
    input, button {
      padding:12px; font-size:15px; width:100%;
    }
    button {
      background:#222; color:#fff; border:none;
      border-radius:6px; cursor:pointer;
    }
    button:hover { opacity:.9; }
    .timeline { margin-top:20px; }
    .item { padding:10px 0; border-bottom:1px dashed #ddd; }
    .badge {
      background:#eee; padding:4px 10px; border-radius:20px;
    }
    .err { color:#b00020; }
  </style>
</head>
<body>

<div class="box">
  <h2>ðŸ“¦ Track Your Shipment</h2>
  <p>Enter your tracking number below:</p>

  <input id="tid" placeholder="MR-2026-001">
  <button onclick="track()">Track</button>

  <p id="msg"></p>

  <div id="result" style="display:none;">
    <p><b>Tracking ID:</b> <span id="r_tid"></span></p>
    <p><b>Current Status:</b> <span class="badge" id="r_status"></span></p>
    <p><b>Last Update:</b> <span id="r_updated"></span></p>

    <div class="timeline">
      <h3>Status History</h3>
      <div id="events"></div>
    </div>
  </div>
</div>

<script>
async function track(){
  const tid = document.getElementById('tid').value.trim();
  const msg = document.getElementById('msg');
  const result = document.getElementById('result');
  msg.textContent = '';
  result.style.display='none';

  if(!tid){
    msg.innerHTML='<span class="err">Please enter a tracking ID</span>';
    return;
  }

  msg.textContent='Searching...';

  try{
    const res = await fetch(`/api/track/${encodeURIComponent(tid)}`);
    const data = await res.json();
    if(!res.ok) throw new Error(data.error || 'Not found');

    document.getElementById('r_tid').textContent=data.trackingId;
    document.getElementById('r_status').textContent=data.currentStatus;
    document.getElementById('r_updated').textContent=
      new Date(data.updatedAt).toLocaleString();

    const events=document.getElementById('events');
    events.innerHTML='';
    data.events.forEach(e=>{
      const div=document.createElement('div');
      div.className='item';
      div.innerHTML=`<b>${e.status}</b><br>
        <small>${new Date(e.createdAt).toLocaleString()}</small><br>
        ${e.note || ''}`;
      events.appendChild(div);
    });

    msg.textContent='';
    result.style.display='block';
  }catch(e){
    msg.innerHTML=`<span class="err">${e.message}</span>`;
  }
}
</script>

</body>
</html>


